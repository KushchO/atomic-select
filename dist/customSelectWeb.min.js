var atomicSelect=function(t){window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var n=0;n<this.length;n++)t.call(e,this[n],n,this)});var e=document.querySelectorAll(t);function _(t,s){var o=document.createElement("ul"),e=t.querySelectorAll("option");return o.classList.add("custom-select__list"),o.classList.add("custom-select__hidden"),e.forEach(function(t,e){var n,a;!0===t.selected&&s.appendChild((n=t,(a=document.createElement("input")).tabIndex=-1,a.classList.add("custom-select__input"),a.placeholder=n.text,a.setAttribute("aria-label",n.text),a)),o.appendChild(function(t,e){var n=document.createElement("li");n.classList.add("custom-select__option"),!0===t.disabled&&n.classList.add("custom-select__option--disabled");return n.dataset.value=t.value,n.dataset.selected=t.selected,n.dataset.disabled=t.disabled,n.dataset.count=e,n.setAttribute("tabindex","-1"),n.textContent=t.text,n}(t,e))}),o}0!==e.length&&e.forEach(function(e,t){var n=document.createElement("li");n.classList.add("custom-select__option"),n.classList.add("custom-select__option--not-found"),n.textContent="Ничего не найдено";var a={status:"closed",activOption:"default",activeItem:"",countClicks:0,inputValue:"",options:[],renderedOptions:[],notFound:n},s=function(t){var e=t.classList,n=document.createElement("div");n.classList.add("custom-select__wrapper"),n.setAttribute("tabindex","-1");for(var a=0;a<e.length;a++)n.classList.add(e[a]);return n.appendChild(_(t,n)),n}(e);e.parentElement.insertBefore(s,e),e.classList.add("custom-select__hidden"),s.setAttribute("tabindex","0");var o=s.querySelector(".custom-select__list"),i=s.querySelector(".custom-select__input");console.log(i);var c=s.querySelectorAll(".custom-select__option");function d(t){"true"!==t.dataset.disabled&&("default"!==a.activOption&&t.textContent!==e.value&&a.activeItem&&(a.activeItem.classList.remove("custom-select__option--active"),a.activeItem.dataset.selected="false"),i.value="",i.placeholder=t.textContent,t.classList.add("custom-select__option--active"),t.dataset.selected=!0,a.activeItem=t,e.value=t.dataset.value,a.activOption=+t.dataset.count)}function l(){o.classList.toggle("custom-select__hidden"),a.status="closed"===a.status?"expanded":"closed","closed"===a.status?(s.focus(),i.style.zIndex=0):i.style.zIndex=10}function u(){i.placeholder!==e.value&&(i.placeholder=e.value)}function r(){o.textContent="",a.renderedOptions=[],a.options.forEach(function(t,e){t.dataset.count=e,a.renderedOptions.push(t),o.appendChild(t),a.activeItem&&(a.activOption=+a.activeItem.dataset.count)})}function p(){i.focus(),"closed"===a.status&&0===a.countClicks&&(a.countClicks=1,a.options.length>a.renderedOptions.length&&r()),u(),a.countClicks=0,l()}function v(t){a.activOption=+t,a.renderedOptions[a.activOption].focus()}function f(){"default"!==a.activOption?(a.activOption===a.renderedOptions.length-1?v(0):a.activOption+=1,a.renderedOptions[a.activOption].focus()):v(0)}function m(){"default"!==a.activOption?(0===a.activOption?v(a.renderedOptions.length-1):--a.activOption,a.renderedOptions[a.activOption].focus()):v(0)}function h(t){switch(t.keyCode){case 27:"expanded"===a.status&&(i.focus(),l());break;case 9:O(t);break;case 13:t.preventDefault(),"closed"!==a.status&&"LI"===document.activeElement.tagName&&d(document.activeElement),p();break;case 40:case 39:if("expanded"===a.status){f();break}l(),f();break;case 38:case 37:if("expanded"===a.status){m();break}l(),m()}}function O(t){var e=t.target;e===s||s.contains(e)||("expanded"===a.status&&l(),document.removeEventListener("keydown",h)),u()}s.appendChild(i),e.disabled&&(i.disabled=!0),c.forEach(function(t){a.options.push(t),a.renderedOptions.push(t)}),s.addEventListener("focusin",function(t){document.addEventListener("keydown",h)}),o.addEventListener("click",function(t){var e=t.target;"LI"===e.tagName&&"true"!==e.dataset.disabled&&(d(e),l())}),i.addEventListener("click",function(){p()}),document.addEventListener("click",function(t){O(t)}),i.addEventListener("input",function(){a.inputValue=i.value,a.renderedOptions=[],a.inputValue&&a.options.forEach(function(t){-1!==t.textContent.toLowerCase().indexOf(a.inputValue.toLowerCase())&&a.renderedOptions.push(t)}),0<a.renderedOptions.length&&(o.textContent="",a.renderedOptions.forEach(function(t,e){t.dataset.count=e,o.appendChild(t)}),a.activOption="default"),0===a.renderedOptions.length&&(o.textContent="",o.appendChild(a.notFound),a.activOption="default"),""===i.value&&(r(),a.activOption="default")});new MutationObserver(function(t){t.forEach(function(t){i.disabled=!0===e.disabled})}).observe(e,{attributes:!0,childList:!1,characterData:!1})})};