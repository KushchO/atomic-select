var atomicSelect=function(t){window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var n=0;n<this.length;n++)t.call(e,this[n],n,this)});var e=document.querySelectorAll(t);function _(s){var o=document.createElement("ul"),t=s.querySelectorAll("option");return o.classList.add("custom-select__list"),o.classList.add("custom-select__hidden"),t.forEach(function(t,e){var n,a;!0===t.selected&&s.parentElement.appendChild((n=t,(a=document.createElement("input")).tabIndex=-1,a.classList.add("custom-select__input"),a.placeholder=n.text,a.setAttribute("aria-label",n.text),a)),o.appendChild(function(t,e){var n=document.createElement("li");n.classList.add("custom-select__option"),!0===t.disabled&&n.classList.add("custom-select__option--disabled");return n.dataset.value=t.value,n.dataset.selected=t.selected,n.dataset.disabled=t.disabled,n.dataset.count=e,n.setAttribute("tabindex","-1"),n.textContent=t.text,n}(t,e))}),o}0!==e.length&&e.forEach(function(e){var t=document.createElement("li");t.classList.add("custom-select__option"),t.classList.add("custom-select__option--not-found"),t.textContent="Ничего не найдено";var n={status:"closed",activOption:"default",activeItem:"",countClicks:0,inputValue:"",options:[],renderedOptions:[],notFound:t};e.parentElement.appendChild(function(t){var e=t.classList,n=document.createElement("div");n.classList.add("custom-select__wrapper"),n.setAttribute("tabindex","-1");for(var a=0;a<e.length;a++)n.classList.add(e[a]);return n.appendChild(_(t)),n}(e)),e.classList.add("custom-select__hidden");var a=e.parentElement,s=a.querySelector(".custom-select__wrapper");s.setAttribute("tabindex","0");var o=a.querySelector(".custom-select__list"),i=a.querySelector(".custom-select__input"),c=a.querySelectorAll(".custom-select__option");function d(t){"true"!==t.dataset.disabled&&("default"!==n.activOption&&t.textContent!==e.value&&n.activeItem&&(n.activeItem.classList.remove("custom-select__option--active"),n.activeItem.dataset.selected="false"),i.value="",i.placeholder=t.textContent,t.classList.add("custom-select__option--active"),t.dataset.selected=!0,n.activeItem=t,e.value=t.dataset.value,n.activOption=+t.dataset.count)}function u(){o.classList.toggle("custom-select__hidden"),n.status="closed"===n.status?"expanded":"closed"}function l(){i.value!==e.value&&(i.value=e.value)}function r(){o.textContent="",n.renderedOptions=[],n.options.forEach(function(t,e){t.dataset.count=e,n.renderedOptions.push(t),o.appendChild(t),n.activeItem&&(n.activOption=+n.activeItem.dataset.count)})}function p(){i.focus(),"closed"===n.status&&0===n.countClicks&&(n.countClicks=1,n.options.length>n.renderedOptions.length&&r()),l(),n.countClicks=0,u()}function v(t){n.activOption=+t,n.renderedOptions[n.activOption].focus()}function f(){"default"!==n.activOption?(n.activOption===n.renderedOptions.length-1?v(0):n.activOption+=1,n.renderedOptions[n.activOption].focus()):v(0)}function m(){"default"!==n.activOption?(0===n.activOption?v(n.renderedOptions.length-1):--n.activOption,n.renderedOptions[n.activOption].focus()):v(0)}function h(t){switch(t.keyCode){case 27:"expanded"===n.status&&(i.focus(),u());break;case 9:O(t);break;case 13:t.preventDefault(),"closed"!==n.status&&"LI"===document.activeElement.tagName&&d(document.activeElement),p();break;case 40:case 39:if("expanded"===n.status){f();break}u(),f();break;case 38:case 37:if("expanded"===n.status){m();break}u(),m()}}function O(t){var e=t.target;e===s||s.contains(e)||("expanded"===n.status&&u(),document.removeEventListener("keydown",h)),l()}s.insertBefore(i,o),c.forEach(function(t){n.options.push(t),n.renderedOptions.push(t)}),s.addEventListener("focusin",function(t){document.addEventListener("keydown",h)}),o.addEventListener("click",function(t){var e=t.target;"LI"===e.tagName&&"true"!==e.dataset.disabled&&(d(e),u())}),i.addEventListener("click",function(){p()}),document.addEventListener("click",function(t){O(t)}),i.addEventListener("input",function(){n.inputValue=i.value,n.renderedOptions=[],n.inputValue&&n.options.forEach(function(t){-1!==t.textContent.toLowerCase().indexOf(n.inputValue.toLowerCase())&&n.renderedOptions.push(t)}),0<n.renderedOptions.length&&(o.textContent="",n.renderedOptions.forEach(function(t,e){t.dataset.count=e,o.appendChild(t)}),n.activOption=0),0===n.renderedOptions.length&&(o.textContent="",o.appendChild(n.notFound),n.activOption=0),""===i.value&&(r(),n.activOption=0)})})};